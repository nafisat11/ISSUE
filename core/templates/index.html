{% extends "layouts/base.html" %}

{% block title %} Dashboard {% endblock %} 

<!-- Specific CSS goes HERE -->
{% block stylesheets %}
<style>
    .wrapper {
        position: relative;
        width: 700px;
        height: 550px;
    }
    .wrapper canvas {
        position: absolute;
        top: 0;
        left: 0;
    }
    .seat_selection_container {
        position: relative;
        max-width: 100%;
    }

    .heatmap_container {
        position: relative;
        max-width: 100%;
    }

    #legend {
        position: absolute;
        top:0;
        bottom: 0;
        left: 0;
        right: 0;
        margin: 72px 0px 0px 730px;
    }

    .image_container {
        max-width: 100%;
    }

    .v-divider {
        margin-left:5px;
        margin-right:5px;
        width:1px;
        height:100%;
        border-left:1px solid gray;
    }

    img {
        max-width: 100%;
    }

    svg {
        width: 100%;
    }

    #grid {
        position: absolute;
        top: 0;
        right : 0;
        width: 100%;
    }

</style>
{% endblock stylesheets %}

{% block content %}
    <!-- [ Main Content ] start -->
    <div class="pcoded-main-container">
        <div class="pcoded-content">
            <!-- [ breadcrumb ] start -->
            <!-- <div class="page-header">
                <div class="page-block">
                    <div class="row align-items-center">
                        <div class="col-md-12">
                            <div class="page-header-title">
                                <h5 class="m-b-10">Dashboard Analytics</h5>
                            </div>
                            <ul class="breadcrumb">
                                <li class="breadcrumb-item"><a href="index.html"><i class="feather icon-home"></i></a></li>
                                <li class="breadcrumb-item"><a href="#!">Dashboard Analytics</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div> -->
            <!-- [ breadcrumb ] end -->
            <!-- [ Main Content ] start -->
            <div class="row">
                <!-- seat-selection start -->
                <div class="col-lg-5">
                    <div class="card">                        
                        <div class="card-header">
                            <h5>Seat Selection</h5>
                            <div class="card-header-right">
                            </div>
                        </div>
                            <!-- <img class="card-img-top" src="/static/assets/images/room_maps/Engineering Block C_170.PNG"> -->
                            <div class="card-body">

                                <div class="image_container" id="background_container">
                                    <img src="/static/assets/images/room_maps/Room_Select.png">
                                </div>
                                <div class="seat_selection_container" id="seat_selection_container">
                                    <div class="image_container">
                                        <img src="" id="floorplan">
                                    </div>
                                    <div class="grid" id="grid"></div>
                                    <br>
                                    <div class="row justify-content-center">
                                        <span style="display:block;float:left;width:400x;" id="num_infected">Agents Infected</span>
                                        <span style="display:block;float:right" id="num_normal">Agents Selected</span>
                                        <div id="agent_slider"></div>
                                    </div>
                                    <!-- <div class="col-sm"><div id="agent_slider"></div></div> -->
                                </div>
                                <!-- <br> -->
                                <div class="row justify-content-center card-option">
                                    <button type="button" class="btn btn-icon btn-outline-primary border-0" id='reset_button'>
                                        <i class="feather icon-refresh-ccw"></i></a>
                                    </button>
                                    <button type="button" class="btn  btn-icon btn-outline-secondary border-0">
                                        <i class="feather icon-grid"></i>
                                    </button>
                                    <button type="button" class="btn  btn-icon btn-outline-success border-0">
                                        <i class="feather icon-square"></i>
                                    </button>
                                    <button type="button" class="btn btn-icon btn-outline-danger border-0" data-toggle="modal" data-target="#random_agents">
                                        <i class="feather icon-hash"></i>
                                    </button>
                                    <div class="modal fade bd-example-modal-sm" id="random_agents" tabindex="-1" role="dialog" aria-labelledby="input_num" aria-hidden="true">
                                        <div class="modal-dialog modal-dialog-centered" role="document">
                                            <div class="modal-content">
                                                <div class="modal-header">
                                                    <h5 class="modal-title" id="input_num">Input Number of Infected Agents</h5>
                                                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                        <span aria-hidden="true">&times;</span>
                                                    </button>
                                                </div>
                                                <div class="modal-body">
                                                    <div class="input-group mb-3">
                                                        <input type="text" class="form-control" placeholder="Number" aria-label="Number">
                                                    </div>
                                                </div>
                                                <div class="modal-footer">
                                                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                                                    <button type="button" class="btn btn-success">Ok</button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <!-- <br> -->
                                <h5 class="text-black">Max Occupancy<span class="float-right maxOccup"></span></h5>
                                <h5 class="text-black">Max Pandemic Occupancy<span class="float-right maxPanOccup"></span>
                            </div>
                        <!-- seat-selection end -->
                        <!-- infection-parameter start -->
                        <div class="dropdown-divider"></div>
                        <div class="card-header">
                            <h4>Infection Parameters</h4>      
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col">
                                    <p><b>Personal Protective Equipment (Mask)</b></p>
                                    <div class="form-check form-check-inline">
                                        <input class="form-check-input" type="radio" name="ppe" id="n95Mask" value="N95">
                                        <label class="form-check-label" for="n95Mask">N95</label>
                                      </div>
                                      <div class="form-check form-check-inline">
                                        <input class="form-check-input" type="radio" name="ppe" id="surgicalMask" value="Surgical">
                                        <label class="form-check-label" for="surgicalMask">Surgical</label>
                                      </div>
                                      <div class="form-check form-check-inline">
                                        <input class="form-check-input" type="radio" name="ppe" id="clothMask" value="Cloth">
                                        <label class="form-check-label" for="clothMask">Cloth</label>
                                    </div>
                                </div>
                                <div class="col v-divider">
                                    <p><b>Duration</b></p>
                                    <input data-suffix="Hours" class="form-control-sm" type="number" id="duration" value="0" min="0" max="10" step="1"/>
                                    <!-- <form class="range-field">
                                        <input id="duration-slider" class="border-0" type="range" min="0">
                                        <span class=valueSpan></span>
                                    </form> -->
                                </div>
                            </div>
                            <!-- <div class="parent" id="seat_selector_container">
                                <div class="panzoom" id="panzoom_container">
                                    <div class="grid" id="grid"></div>
                                    <img src="/static/assets/images/room_maps/Engineering Block C_170.PNG">
                                </div>
                            </div> -->
                            
                        </div>
                        <div class="card-footer">
                            <button type="button" id="GenerateHeatmap" class="btn btn-success">Generate</button>
                        </div>
                        <!-- infection-parameter end -->
                    </div>
                </div>
                <!-- seat-selection end -->
                <!-- heat-map start -->
                <div class="col-lg-7">
                    <div class="card">
                        <div class="card-header"><h5>Heat Map</h5></div>
                        <div class="card-body">
                            <div class="heatmap_container" id="heatmap_container">
                                <div id="probabilitiesSelect"></div>
                                <div class="wrapper">
                                    <div><canvas id="backgroundCanvas" width="700" height="550"></canvas></div>
                                    <div><canvas id="heatmapCanvas" width="700" height="550" style="opacity:0.5"></canvas></div>
                                </div>
                            </div>
                            <div class="dropdown-divider"></div>
                            <div class="card-body">
                                <h4>Alberta Health Services Guidelines</h4>
                                <ul class="nav nav-pills mb-3" id="pills-tab" role="tablist">
                                    <li class="nav-item" role="presentation">
                                      <a class="nav-link active" id="pills-covid-tab" data-toggle="pill" href="#pills-covid" role="tab" aria-controls="pills-covid" aria-selected="true">COVID-19</a>
                                    </li>
                                    <li class="nav-item" role="presentation">
                                      <a class="nav-link" id="pills-virus2-tab" data-toggle="pill" href="#pills-virus2" role="tab" aria-controls="pills-virus2" aria-selected="false">Virus2</a>
                                    </li>
                                    <li class="nav-item" role="presentation">
                                      <a class="nav-link" id="pills-virus3-tab" data-toggle="pill" href="#pills-virus3" role="tab" aria-controls="pills-virus3" aria-selected="false">Virus3</a>
                                    </li>
                                  </ul>
                                  <div class="tab-content" id="pills-tabContent">
                                    <div class="tab-pane fade show active" id="pills-covid" role="tabpanel" aria-labelledby="pills-covid-tab">
                                        <li>Stay 2 metres apart from others</li>
                                        <li>Wear a mask in public spaces, indoor workplaces and places of worship</li>
                                        <br>
                                        <p>Referenced from AHS<a href="https://www.alberta.ca/enhanced-public-health-measures.aspx#PathForward"> website</a></p>
                                    </div>
                                    <div class="tab-pane fade" id="pills-virus2" role="tabpanel" aria-labelledby="pills-virus2-tab">...</div>
                                    <div class="tab-pane fade" id="pills-virus3" role="tabpanel" aria-labelledby="pills-virus3-tab">...</div>
                                  </div>    
                            </div>
                        </div>
                        
                        <div id="legend_container">
                            <canvas id="legend" width="120" height="550"></canvas>
                        </div>
                    </div>
                </div>
                <div class="card-body d-flex flex-column">
                    <div class="card">
                        <div class="card-header"><h5>Temporal Graph</h5></div>
                        <div class="card-body d-flex flex-column">
                            <div id="temporal1"></div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- [ Main Content ] end -->
        </div>
    </div>
    <!-- [ Main Content ] end -->

{% endblock content %}

<!-- Specific Page JS goes HERE  -->
{% block javascripts %}

    <!-- Apex Chart -->
    <script src="/static/assets/js/pages/chart-apex.js"></script>
    <script src="/static/assets/js/plugins/apexcharts.min.js"></script>
    <script>
    </script>

    <!-- infection-parameter js -->
    <script src="./static/assets/js/bootstrap-input-spinner.js"></script>
    <script>
        $("input[type='number']").inputSpinner()
        // $('#duration').on("change", function (event) {
        //     time_duration = $('#duration').val();
        //     if (time_duration != 0) {
        //         $.ajax({
		// 			type: "GET",
		// 			url: '/get_attack_rates/',
		// 			data: {"duration": time_duration},
		// 		});
        //     }
        // });
    </script>

    <!-- <script src="/static/assets/js/pages/dashboard-main.js"></script>
    <script>
        $(document).ready(function() {
            const $valueSpan = $('.valueSpan');
            const $value = $('#duration-slider');
            $valueSpan.html($value.val());
            $value.on('input change', () => {

                $valueSpan.html($value.val());
            });
        });
    </script> -->

    <!-- seat-selection js-->
    <script src="https://d3js.org/d3.v5.js"></script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://d3js.org/d3-scale-chromatic.v1.min.js"></script>
    <script src="http://cdnjs.cloudflare.com/ajax/libs/gsap/1.18.0/TweenMax.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.panzoom/4.0.0/panzoom.min.js"></script>
    <script src="https://unpkg.com/d3-simple-slider"></script>
    <script src="./static/assets/js/simpleheat.js"></script>
    <script src="./static/assets/js/bootstrap-input-spinner.js"></script>
    <script>
    $.noConflict();
    
    var ROOM_MAP_PATH = "/static/assets/images/room_maps/Engineering Block C_170.png";


    var ROOM_NAME = ROOM_MAP_PATH.split("/");
    ROOM_NAME = ROOM_NAME[ROOM_NAME.length - 1];
    ROOM_NAME = ROOM_NAME.split(".")[0].concat(".json");
    console.log(ROOM_NAME);
    var POSITIONS_PATH = "/static/assets/json/seat_positions/";

    var SEAT_POSITIONS_PATH = POSITIONS_PATH.concat(ROOM_NAME);
    var cache_seat_locations = [];

    // console.log(SEAT_POSITIONS_PATH);
    
        // define index values mapping to different state colours
    var WHITE = 0, GRAY = 1, RED = 2;

    // utility function to randomize ordering of array elements
    function shuffle(array) {
        var currentIndex = array.length, temporaryValue, randomIndex;

        // While there remain elements to shuffle...
        while (0 !== currentIndex) {

            // Pick a remaining element...
            randomIndex = Math.floor(Math.random() * currentIndex);
            currentIndex -= 1;

            // And swap it with the current element.
            temporaryValue = array[currentIndex];
            array[currentIndex] = array[randomIndex];
            array[randomIndex] = temporaryValue;
        }

        return array;
    }

    function grid (config) {
        
        // defaults
        config = Object.assign({size:15, num_states:2, x_margin:2, y_margin:2, outline:'#000'}, config);  
        let {nx, ny, size, num_states, init, x_margin, y_margin, colour_array, outline, nodes, n_default, width, height} = config;
        
        if (colour_array === undefined)
            colour_array = Array.from({length:num_states}, (d,i) => i === 0 ? '#FFF' : 
                                                            (i === 1 ? d3.schemeSet3[0] : '#FF2323'));

        // randomize ordering of array elements
        nodes = shuffle(nodes);
        var node_IDs = [];
        var selected_nodes = [];

        // create a dictionary to maintain list of nodes by ID
        var node_map = {};
        for (let i = 0; i < nodes.length; i++) {
            if (i < n_default) {
                nodes[i].state = 1;
                nodes[i].colour = colour_array[GRAY];
                //console.log(nodes[i]);
            } else {
                nodes[i].state = 0;
                nodes[i].colour = colour_array[WHITE];
            }
            id = String(nodes[i].id);
            node_map[id] = nodes[i];
            node_IDs.push(id);
        }

        // append the svg object to the body of the page
        const svg = d3.select("#grid").append("svg");

        svg
            .attr("width", width)
            .attr("height", height);
            //.attr("style", 'background-color:gray');        

        const el = svg.node();
        const grid = svg.append("g")
                .attr("cursor", "pointer")
            .selectAll("rect")
            .data(nodes)
            .join("circle")
                .on("click", gridClick)
                .on("mouseover", hoverOver)
                .on("mouseout", hoverOff)
                .attr("cx", d => d.x * width)
                .attr("cy", d => d.y * height)
                .attr("id", d => "node_" + d.id)
                .attr("fill", d => d.colour)
                .attr("stroke", outline)
                .attr("r", size)

        // initialize slider to default values
        make_slider([0, n_default]);

        // ################## POST function for node selections ##################
        function post_node_selections() {
            // loop through all list to determine which have a non-zero state
            selected_nodes = [];
            var count = 0;
            for (node_ID in node_map) {
                var node = node_map[node_ID];
                if (node.state != 0) {
                    node.attRate = 0.05;
                    selected_nodes.push(node);
                }
                if (node.state === 2) {
                    count++;
                }
            }
            // JSON-ify the selected node data
            selected_nodes_JSON = JSON.stringify(selected_nodes);
            // console.log(selected_nodes_JSON)
            // POST JSON-ified node data
            $.ajax({
             url: "/post_seat_selections/",
                method : "POST",
                dataType : "json",
                data : {'data': selected_nodes_JSON},
            });
            return [count, selected_nodes.length, selected_nodes_JSON];
        }

        // ################## slider creation & utility functions ##################
        function make_slider(default_value) {
            // define slider settings
            var slider = d3
                .sliderBottom()
                .min(0)
                .max(nodes.length)
                .width(image_width - 50)
                .ticks(nodes.length / 10)
                .step(1)
                .tickFormat(d3.format(""))
                .default(default_value)
                .fill('#2196f3')
                .handle(
                  d3
                    .symbol()
                    .type(d3.symbolCircle)
                    .size(300)()
                )
                .on('onchange', val => {
                    var num_to_infect = val[0];
                    var num_to_select = val[1];
                    var selected = select_n_nodes(num_to_select);
                    select_n_infected(num_to_infect, selected);
                    var values = post_node_selections();
                });

            var gSlider = d3
                .select('div#agent_slider')
                .append('svg')
                .attr('id', 'slider_svg')
                .attr('width', 1000)
                .attr('height', 200)
                .append('g')
                .attr('transform', 'translate(30,30)');

            gSlider.call(slider);
        }

        function select_n_nodes(num) {
            selected = [];
            for (let i = 0; i < nodes.length; i++) {
                var id = node_IDs[i];
                // update internal node states
                if (i < num) {
                    if (node_map[id].state === 0) {
                        node_map[id].state = 1;
                        node_map[id].colour = colour_array[GRAY];
                    }
                    selected.push(id);
                } else {
                    if (node_map[id].state != 0) {
                        node_map[id].state = 0;
                        node_map[id].colour = colour_array[WHITE];
                    }
                }
                // update node colours
                var node_tag = "#node_" + String(id);
                svg.select(node_tag).style('fill', node_map[id].colour);
                el.dispatchEvent(new CustomEvent('input'));
            }
            return selected;
        }

        function select_n_infected(num_to_infect, selected) {
            selected = shuffle(selected);
            for (let i = 0; i < selected.length; i++) {
                var id = selected[i];
                // update internal node states
                if (i < num_to_infect) {
                    if (node_map[id].state === 1) {
                        node_map[id].state = 2;
                        node_map[id].colour = colour_array[RED];
                    }
                } else {
                    node_map[id].state = 1;
                    node_map[id].colour = colour_array[GRAY];
                }
                // update node colours
                var node_tag = "#node_" + String(id);
                svg.select(node_tag).style('fill', node_map[id].colour);
                el.dispatchEvent(new CustomEvent('input'));
            }
        }

        // ################## manual selection call-back functions ##################
        function hoverOver({x, y, id}) {
            d3.select(this).style('stroke-width', '5');
        }

        function hoverOff({x, y, id}) {
            d3.select(this).style('stroke-width', '1');
        }

        function gridClick({x, y, id}) {
            // update node state & fill colour
            node_map[id].state = (node_map[id].state + 1) % num_states;
            node_map[id].colour = colour_array[node_map[id].state];
            this.style.fill = node_map[id].colour;
            el.dispatchEvent(new CustomEvent('input'));
            // POST node selections
            var values = post_node_selections();
            // delete and remake slider with updated values
            d3.select('#slider_svg').remove();
            make_slider(values.slice(0,1));
            agent_nodes = values[2];

            heatmapWidth = 700;
            heatmapHeight = 550;
            var duration = $("#duration").val();
            var maskType = $("input[name='ppe']:checked").val();

            $("#GenerateHeatmap").click(function(event) {
                console.log("Hello");
                event.preventDefault();
                $.ajax({
                    type: "GET",
                    url: "/get_attack_rates",
                    data: {'seat_selections': agent_nodes, 'mask_type': maskType, 'duration': duration},
                    success: function(result) {
                        resultArray = [result.attack_rates];
                        resultTemporal = [result.temporal];
                        finalResult = [];
                        finalResultTemporal = [];
                        for(var i = 0; i < resultArray.length; i++)
                        {
                            finalResult = finalResult.concat(resultArray[i]);
                        }
                        for (var i = 0; i < finalResult.length; i++){
                            finalResult[i][0] = finalResult[i][0]*heatmapWidth;
                            finalResult[i][1] = finalResult[i][1]*heatmapHeight;
                        }
                        for(var i = 0; i < resultTemporal.length; i++)
                        {
                            finalResultTemporal = finalResultTemporal.concat(resultTemporal[i]);
                        }
                        drawTemporal(finalResultTemporal);
                    }
                });
            })            
        }
        console.log(cache_seat_locations);
        return el;
        

    }

    var image = new Image();
    image.src = ROOM_MAP_PATH;
    //var image_width = image.width;
    //var image_height = image.height;
    var image_width = document.getElementsByClassName("image_container")[0].clientWidth;
    var image_height = document.getElementsByClassName("image_container")[0].clientHeight;
    
    function readTextFile(file, callback) {
        var rawFile = new XMLHttpRequest();
        rawFile.overrideMimeType("application/json");
        rawFile.open("GET", file, true);
        rawFile.onreadystatechange = function() {
            if (rawFile.readyState === 4 && rawFile.status == "200") {
                callback(rawFile.responseText);
            }
        }
        rawFile.send(null);
    }

    readTextFile(SEAT_POSITIONS_PATH, function(text){
        positions = JSON.parse(text);
        // console.log(positions);
        grid = grid({
            width: 608,
            height: 518,
            num_states: 3, 
            size: 8,
            nodes: positions,
            n_default : positions.length / 2
        });
    });

    // function heatmapData(seats) {
    //     console.log(seats.seat_selections);
    //     heatmapWidth = 700;
    //     heatmapHeight = 550;
    //     $.ajax({
    //         type: "GET",
    //         url: "/get_attack_rates",
    //         data: {'seat_selections': seats.seat_selections},
    //         success: function(result) {
    //             resultArray = Object.values(result);
    //             finalResult = [];
    //             for(var i = 0; i < resultArray.length; i++)
    //             {
    //                 finalResult = finalResult.concat(resultArray[i]);
    //             }
    //             for (var i = 0; i < finalResult.length; i++){
    //                 finalResult[i][0] = finalResult[i][0]*heatmapWidth;
    //                 finalResult[i][1] = finalResult[i][1]*heatmapHeight;
    //             }
    //             drawHeatMap(finalResult);
    //         }
    //     });
    // }
    </script>

    <!-- heat-map js-->
    <script>
    //Update Background Image
    function setBackground(buildingName, roomName){
        roomName = roomName;
        imageLocation = "/static/assets/images/room_maps/";
        fileType = ".png";
        
        //Updating background with "new" room map
        var c = document.getElementById("backgroundCanvas");
        var ctx = c.getContext("2d");
        var background = new Image();
        background.src = imageLocation.concat(buildingName, "_", roomName, fileType);
        background.onload = function(){
                  ctx.drawImage(background, 0, 0, 700, 550);
        };

        // legend
        var clegend = document.getElementById("legend");
        var ctxlegend = clegend.getContext("2d");
        var legend = new Image();
        legend.src = "/static/assets/images/heatmap-legend.png";
        legend.onload = function(){
            ctxlegend.drawImage(legend, 0, 0, 120, 550);
        };

        if (typeof heat !== 'undefined'){
            heat.clear();
            heat.draw();
        }
        // else {
        //     showGenerateButton();
        // }
    }

    // function showGenerateButton(){
    //     document.getElementById('generatebutton').removeAttribute('disabled');
    // }

    //Heatmap Background Image
    var canvas = document.getElementById("backgroundCanvas");
    var ctx = canvas.getContext("2d");
    var background = new Image();
    background.src = "/static/assets/images/room_maps/Room_Select.png";

    // Make sure the image is loaded first otherwise nothing will draw.
    background.onload = function(){
        ctx.drawImage(background, 0, 0, 700, 550);
    }
    function drawHeatMap(sampleData){
        var heat = simpleheat('heatmapCanvas').data(sampleData).max(1);
        heat.draw();
        function draw() {
            heat.draw();
        }
        draw();
    }

    function drawTemporal(temporalData){
        // Temporal Graph
        temporalXData = [];
        temporalYData = [];
        for(var i = 0; i < temporalData.length; i++){
            temporalXData = temporalXData.concat(temporalData[i][0]);
            temporalYData = temporalYData.concat(temporalData[i][1]);
        }
        // Chart customization
        var options = {
            series: [{
                name: "Attack Rate",
                data: temporalYData
            }],
            chart: {
            height: 350,
            type: 'line',
            zoom: {
                type: 'x',
                enabled: true,
                autoScaleYaxis: true
            },
            toolbar: {
                autoSelected: 'zoom'
            }
            },
            dataLabels: {
            enabled: false
            },
            stroke: {
            curve: 'smooth'
            },
            title: {
            text: 'Attack Rate as a Function of Time',
            align: 'left'
            },
            xaxis: {
            categories: temporalXData,
            title: {
                text: "Time (mins)"
            }
            },
            yaxis: {
                title: {
                    text: "Attack Rate Increase Factor"
                }
            },
            tooltip: {
                enabled: true,
                enabledOnSeries: undefined,
                shared: true,
                followCursor: false,
                intersect: false,
                inverseOrder: false,
                custom: undefined,
                fillSeriesColor: false,
                theme: false,
                style: {
                    fontSize: '12px',
                    fontFamily: undefined
                },
                onDatasetHover: {
                    highlightDataSeries: false,
                },
                x: {
                    show: true,
                    format: 'dd MMM',
                    formatter: undefined,
                },
                y: {
                    formatter: undefined,
                    title: {
                        formatter: (seriesName) => seriesName,
                    },
                },
                z: {
                    formatter: undefined,
                    title: 'Size: '
                },
                marker: {
                    show: true,
                },
                fixed: {
                    enabled: false,
                    position: 'topRight',
                    offsetX: 0,
                    offsetY: 0,
                },
            }
        };
        var chart = new ApexCharts(document.querySelector("#temporal1"), options);
        chart.render();
    }
    </script>

{% endblock javascripts %}